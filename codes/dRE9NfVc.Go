package noobcrypt

var defcon []int = []int{3, 4, 5, 1, 1 , 5, 12, 13, 2, 1 , 15, 8, 17, 1, 3 , 7, 24, 25, 3, 1, 21, 20, 29, 2, 3, 35, 12, 37, 1, 5 , 9, 40, 41, 4, 1 , 45, 28, 53, 2, 5 , 11, 60, 61, 5, 1, 33, 56, 65, 4, 3, 63, 16, 65, 1, 7 , 55, 48, 73, 3, 5 , 13, 84, 85, 6, 1 , 77, 36, 85, 2, 7 , 39, 80, 89, 5, 3 , 65, 72, 97, 4, 5 , 99, 20, 101, 1, 9 , 91, 60, 109, 3, 7 , 15, 112, 113, 7, 1 , 117, 44, 125, 2, 9 , 105, 88, 137, 4, 7 , 17, 144, 145, 8, 1 , 143, 24, 145, 1, 11 , 51, 140, 149, 7, 3 , 85, 132, 157, 6, 5 , 119, 120, 169, 5, 7 , 165, 52, 173, 2, 11 , 19, 180, 181, 9, 1 , 57, 176, 185, 8, 3 , 153, 104, 185, 4, 9 , 95, 168, 193, 7, 5 , 195, 28, 197, 1, 13 , 133, 156, 205, 6, 7 , 187, 84, 205, 3, 11 , 21, 220, 221, 10, 1 , 171, 140, 221, 5, 9 , 221, 60, 229, 2, 13 , 105, 208, 233, 8, 5 , 209, 120, 241, 4, 11 , 255, 32, 257, 1, 15 , 23, 264, 265, 11, 1 , 247, 96, 265, 3, 13 , 69, 260, 269, 10, 3, 115, 252, 277, 9, 5 , 231, 160, 281, 5, 11 , 161, 240, 289, 8, 7 , 285, 68, 293, 2, 15 , 207, 224, 305, 7, 9 , 273, 136, 305, 4, 13 , 25, 312, 313, 12, 1 , 75, 308, 317, 11, 3 , 253, 204, 325, 6, 11 , 323, 36, 325, 1, 17 , 175, 288, 337, 9, 7 , 299, 180, 349, 5, 13 , 225, 272, 353, 8, 9 , 27, 364, 365, 13, 1 , 357, 76, 365, 2, 17 , 275, 252, 373, 7, 11 , 135, 352, 377, 11, 5 , 345, 152, 377, 4, 15 , 189, 340, 389, 10, 7, 325, 228, 397, 6, 13 , 399, 40, 401, 1, 19 , 391, 120, 409, 3, 17 , 29, 420, 421, 14, 1 , 87, 416, 425, 13, 3 , 297, 304, 425, 8, 11 , 145, 408, 433, 12, 5 , 203, 396, 445, 11, 7 , 437, 84, 445, 2, 19 , 351, 280, 449, 7, 13 , 425, 168, 457, 4, 17 , 261, 380, 461, 10, 9 , 31, 480, 481, 15, 1, 319, 360, 481, 9, 11 , 93, 476, 485, 14, 3 , 483, 44, 485, 1, 21 , 155, 468, 493, 13, 5, 475, 132, 493, 3, 19 , 217, 456, 505, 12, 7 , 377, 336, 505, 8, 13 , 459, 220, 509, 5, 17 , 279, 440, 521, 11, 9 , 435, 308, 533, 7, 15 , 525, 92, 533, 2, 21 , 341, 420, 541, 10, 11 , 33, 544, 545, 16, 1 , 513, 184, 545, 4, 19 , 165, 532, 557, 14, 5 , 403, 396, 565, 9, 13 , 493, 276, 565, 6, 17 , 231, 520, 569, 13, 7 , 575, 48, 577, 1, 23 , 465, 368, 593, 8, 15 , 551, 240, 601, 5, 19 , 35, 612, 613, 17, 1, 105, 608, 617, 16, 3, 527, 336, 625, 7, 17 , 429, 460, 629, 10, 13 , 621, 100, 629, 2, 23}

func Shuffle (key, dataset []byte) (result []byte) {
	var a, b, c, d, e int;
	keylen := len(key)
	deflen := len(defcon)
	for x, y := range dataset {
		a = (a << 16 | a >> 16) + b
		b, c = func() (int, int) { return (b << 12 | c >> 20),(c<<7 | b>> 25) }()
		e = (e ^ x ^ int(key[(x+d) % keylen])) % 32
		d = d ^ int(key[x % keylen])
		b = b ^ defcon[e % deflen]
		result = append(result, y ^ byte((a ^ b ^ d ^ e) % 256))
	}
	return
}